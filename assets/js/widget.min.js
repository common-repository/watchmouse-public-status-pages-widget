/**
 * @package			WatchMouse PSP Widgets
 * @subpackage		PSP Widget - WordPress Plugin
 * @link			http://www.watchmouse.com
 * @copyright		Copyright (C) 2011 - 2012 WatchMouse b.v.. All rights reserved.
*/
// compressed using YUI compressor
var wm_psp_charts={widget_defaults:{defaults:{widget_container_id:"#wm-chart-widget",widget_mod_container_id:"#wm-chart-mod-widget",psp_page_container_id:"#wm-psp-page",psp_page_uptime_table_id:"#wm-psp-uptime-table",psp_page_history_table_id:"#wm-psp-history-table",psp_page_curr_status:"#wm-psp-curr-status",psp_page_last_update:"#psp_last_update",widget_captions:1,gv_formatter_loaded:false},messages:{uid_not_valid:"Please fill a valid WM Account id",rid_not_valid:"Please fill a valid WM Folder/Monitor id",request_timeout:"Data request timeout.",error:"Data could not be loaded at this time. Please try again in a minute.",empty_chart_data:"There is no data for that chart. Try later.",empty_table_data:"There is no data for that table. Try later.",psp:{uptime:"Uptime",view_details:"View Details",last_update:"Last update"},charts:{backgroung_color:"#fff",text_color:"#4c4c4c",hours:"Hours",days:"Days",total_time:"Total Time",min_load_time:"Min Load Time",max_load_time:"Max Load Time",country:"Country",performance:"Performance",apdex_score:"Apdex Score",axis_titles:{total_load_time:"Total load time in ms",uptime_perc:"Uptime percentage[%]"},rtime:{name:"Resolve",unit:"ms"},ctime:{name:"Connect",unit:"ms"},ptime:{name:"Processing",unit:"ms"},ttime:{name:"Transfer",unit:"ms"},uptime:{name:"Up",unit:"%"},downtime:{name:"Down",unit:"%"},colors:["#669900","#CC0000","#EEA111","#119dee","#BDBDBD","#ee11b7","#1116ee","#11ee5f","#a811ee","#116fee"]},captions:{HourlyUptime:"Uptime over the last 24 hours",DailyUptime:"Uptime over the last 7 days",HourlyPageLoadTime:"Performance indication by country over the last 24 hours",WorldDailyPerformance:"Average daily performance for this service from selected countries",Sparkline:"Performance last 24h",Gauges:"Current Performance"},status_states:{0:{text:"Service is operating normally",image:"images/icn-green.png"},1:{text:"Performance issues",image:"images/icn-yellow.png"},2:{text:"Service disruption",image:"images/icn-red.png"},3:{text:"Informational message",image:"images/icn-grey-black.png"},4:{text:"-",image:"images/icn-grey-black.png"}},months:{0:"Jan",1:"Feb",2:"Mar",3:"Apr",4:"May",5:"Jun",6:"Jul",7:"Aug",8:"Sep",9:"Oct",10:"Nov",11:"Dec"}},urls:{mongo_cache_api:"http://api.io.watchmouse.com/",s3_url_assets:"http://wmassets.s3.amazonaws.com"},chart_options:{area:{top:10,left:70,height:"82%",width:"84%"},area_legend:{top:10,left:70,height:"82%",width:"84%"},font_size:"10",show_text_hours:"3",show_text_days:"2"},country_names:{}},initMap:function(a){var b=wm_psp_charts.urls.mongo_cache_api+"latest/synth/current/"+parseInt(WM_instances[a].uid,10);if(typeof(WM_instances[a].rid)!=="undefined"&&WM_instances[a].rid!==0){b+="/monitor/"+parseInt(WM_instances[a].rid,10)+"?callback=?"}else{b+="/folder/"+parseInt(WM_instances[a].fid,10)+"?callback=?"}jQuery.jsonp({url:b,data:WM_instances[a].fields,dataType:"jsonp",timeout:10000,success:function(c){if(c.code!==200){wm_psp_charts.handleError(c.info,a)}else{c.result.sort(wm_psp_charts.SortByName);wm_psp_charts.loadPackages(c,a)}},error:function(c,e,d){wm_psp_charts.handleError(e,a)}})},loadPackages:function(c,a){if(typeof(WM_instances[a].is_module)==="undefined"&&wm_psp_charts.iframe_version_widget!==true){wm_psp_charts.fillDates(c)}if(a==="0"){wm_psp_charts.loadMonitorsUptime(c,a);wm_psp_charts.loadMonitorsHistory(c,a)}if(typeof(WM_instances[a].is_module)!=="undefined"||a!=="0"){google.load("visualization","1.1",{packages:WM_instances[a].visualization_packages,callback:function(){var e=WM_instances[a].chart_types.length,f=0;while(f<e){switch(WM_instances[a].chart_types[f]){case"HourlyUptime":wm_psp_charts.drawHourlyUptime(c,a);break;case"DailyUptime":wm_psp_charts.drawDailyUptime(c,a);break;case"HourlyPageLoadTime":wm_psp_charts.drawHourlyPageLoadTime(c,a);break;case"WorldDailyPerformance":wm_psp_charts.drawWorldDailyPerformance(c,a);break;case"Sparkline":wm_psp_charts.drawSparkline(c,a);break;case"Gauge":wm_psp_charts.drawGauges(c,a);break}f++}}})}if(typeof(WM_instances[a].is_module)==="undefined"&&wm_psp_charts.iframe_version_widget!==true){if(a!=="0"){if(typeof(c.result[0].info)!=="undefined"&&typeof(c.result[0].info.name)!=="undefined"){var b=2;if(typeof(c.result[0].cur.status)!=="undefined"){b=c.result[0].cur.status}var d='<img src="'+WM_instances[a].assets_folder_com+wm_psp_charts.msgs.status_states[b].image+'" alt="'+c.result[0].info.name+'" /><span>'+wm_psp_charts.msgs.status_states[b].text+"</span>";jQuery(wm_psp_charts.opts.psp_page_curr_status).prepend(d).removeClass("wm-hidden")}wm_psp_charts.loadMonitorsHistory(c,a)}}},loadMonitorsUptime:function(c,j){var e=c.result.length;if(e<1||(typeof(c.result[0]["24h"])==="undefined")){wm_psp_charts.handleEmptyDataError(wm_psp_charts.opts.psp_page_uptime_table_id,5);jQuery(wm_psp_charts.opts.psp_page_uptime_table_id).removeClass("wm-hidden");jQuery(".loading-uptime").remove();return false}var k,a,h,d,f,b,g;for(i=0;i<e;i++){g=c.result[i];check_monitors_data_are_last_7d=wm_psp_charts.makeDate(g["24h"].period.from.sec*1000,g.info.tz);if(wm_psp_charts.weekDates[6]>check_monitors_data_are_last_7d){continue}k=g.info.id;a=g.info.name;h=wm_psp_charts.getDateStr(g["24h"].period.from.sec*1000,g.info.tz,"last");d=(typeof(g.cur.status)!=="undefined")?g.cur.status:4;f=(typeof(g["24h"].avg.ttime)!=="undefined"&&d!==4)?parseInt(g["24h"].avg.ttime,10)+" ms":"-";b=(typeof(g["24h"].uptime)!=="undefined"&&d!==4)?wm_psp_charts.round_number(g["24h"].uptime,1)+"%":"-";wm_psp_charts.addMonitorUptime(j,k,a,h,d,f,b);if(i===0){jQuery(wm_psp_charts.opts.psp_page_uptime_table_id).removeClass("wm-hidden")}}jQuery(".loading-uptime").remove();jQuery(wm_psp_charts.opts.psp_page_uptime_table_id).find("tr:odd").css("background-color","#eeeeee")},addMonitorUptime:function(b,g,e,f,d,a,h){var c='<tr>\n<td height="30px" width="3%">'+wm_psp_charts.setStatus(b,d)+'</td>\n<td><a href="'+wm_psp_charts.createLink(b,g,e)+'" title="'+wm_psp_charts.msgs.psp.last_update+": "+f+'">'+e+"</a></td>\n<td>"+wm_psp_charts.setStatus(b,d,"text")+"</td>\n<td>"+a+"</td>\n<td>"+h+"</td>\n</tr>";jQuery(wm_psp_charts.opts.psp_page_uptime_table_id).append(c)},loadMonitorsHistory:function(d,m){var g=d.result.length;if(g<1||(typeof(d.result[0].daily)==="undefined")){wm_psp_charts.handleEmptyDataError(wm_psp_charts.opts.psp_page_history_table_id,8);jQuery(wm_psp_charts.opts.psp_page_history_table_id).removeClass("wm-hidden");jQuery(".loading-history").remove();return false}var b=d.result[0].daily.length;if(m!=="0"){g=1}var n,a,l=[],f=[],e=[],k,h;for(i=0;i<g;i++){k=d.result[i];b=d.result[i].daily.length;check_monitors_data_are_last_7d=wm_psp_charts.makeDate(k.last.date.sec*1000,k.info.tz);if(wm_psp_charts.weekDates[6]>check_monitors_data_are_last_7d){continue}n=k.info.id;a=k.info.name;var j=b-1;l.length=0;f.length=0;e.length=0;for(y=0;y<wm_psp_charts.weekDates.length;y++){var h=null;if(j===-1){j=b-1}l[y]=wm_psp_charts.weekDates[y].getFullYear()+" "+wm_psp_charts.weekDates[y].getMonth()+" "+wm_psp_charts.weekDates[y].getDate();for(var c=0;c<b;c++){if(typeof(k.daily[j])==="undefined"){break}date2=new Date(k.daily[j].period.from.sec*1000);date_str_2=date2.getFullYear()+" "+date2.getMonth()+" "+date2.getDate();j--;if(l[y]===date_str_2){h=k.daily[j+1];break}}if(h!==null){f[y]=h.status;e[y]=wm_psp_charts.round_number(h.uptime,1)+"%"}}wm_psp_charts.addMonitorHistory(m,n,a,l,f,e);if(i===0){jQuery(wm_psp_charts.opts.psp_page_history_table_id).removeClass("wm-hidden")}}jQuery(".loading-history").remove();jQuery(wm_psp_charts.opts.psp_page_history_table_id).find("tr:odd").css("background-color","#eeeeee")},addMonitorHistory:function(k,l,a,g,e,d){var b="<tr>\n";if(k==="0"){b+='<td><a href="'+wm_psp_charts.createLink(k,l,a)+'" title="'+wm_psp_charts.msgs.psp.view_details+'">'+a+"</a></td>\n"}if(typeof(e)!=="undefined"&&typeof(e)==="object"){var f=7;for(z=0;z<f;z++){var c=(typeof(e[z])!=="undefined")?e[z]:4;var j=(typeof(d[z])!=="undefined")?d[z]:"-";var h=(c!==4)?0:"text";b+='<td class="center">'+wm_psp_charts.setStatus(k,c,h,j)+"</td>\n"}}b+="</tr>";jQuery(wm_psp_charts.opts.psp_page_history_table_id).append(b)},createLink:function(b,d,c){var a;c=c.replace(/\\p{L}[^a-zA-Z 0-9\-]+/g,"").toLowerCase().replace(/\s/g,"-");var e=/(index\.php)/;if(WM_instances[b].seo_friendly===true||!e.test(WM_instances[b].component_url)){a=WM_instances[b].component_url+"/"+d+"/"+c;WM_instances[b].seo_friendly=true}else{a=WM_instances[b].component_url+"&rid="+d+"&rname="+c}return a},setStatus:function(b,c,d,e){var a;if(d==="text"){a=wm_psp_charts.msgs.status_states[c].text;if(c===2){a='<span class="caution">'+a+"</span>"}}else{e=(typeof(e)!=="undefined")?' alt="<b>'+wm_psp_charts.msgs.psp.uptime+":</b> "+e+'" class="wm-tooltip"':"";a='<img src="'+WM_instances[b].assets_folder_com+wm_psp_charts.msgs.status_states[c].image+'"'+e+" />"}return a},drawHourlyUptime:function(b,h){var a=b.result[0].hourly.length;if(a<1){wm_psp_charts.handleEmptyDataError("#HourlyUptime-"+h,"chart");return false}var e=new google.visualization.DataTable();e.addRows(a);e.addColumn("string",wm_psp_charts.msgs.charts.hours);e.addColumn("number",wm_psp_charts.msgs.charts.uptime.name);var f,k=100,g;for(i=0;i<a;i++){f=b.result[0].hourly[i];dateString=wm_psp_charts.getDateStr(f.period.from.sec*1000,b.result[0].info.tz);g=parseInt(f.uptime,10);k=(g<k)?g:k;e.setValue(i,0,dateString);e.setValue(i,1,g)}var j={width:WM_instances[h].widget_width,height:WM_instances[h].widget_height,is3D:false,fontSize:wm_psp_charts.chart_options.font_size,isStacked:false,pointSize:2,vAxis:{title:wm_psp_charts.msgs.charts.axis_titles.uptime_perc,minValue:k-3,maxValue:100,textStyle:{color:wm_psp_charts.msgs.charts.text_color}},hAxis:{title:wm_psp_charts.msgs.charts.hours,showTextEvery:wm_psp_charts.chart_options.show_text_hours,textStyle:{color:wm_psp_charts.msgs.charts.text_color}},legend:"none",backgroundColor:{stroke:null,fill:wm_psp_charts.msgs.charts.backgroung_color,strokeWidth:0},gridlineColor:"#b2b2b2",colors:["#669900","#CC0000"],chartArea:wm_psp_charts.chart_options.area};if(80>k&&k>=70){j.vAxis.minValue=60}else{if(60>k&&k>=55){j.vAxis.minValue=40}else{if(40>k&&k>=0){j.vAxis.minValue=0}}}var c=document.getElementById("HourlyUptime-"+h);var d=new google.visualization.AreaChart(c);d.draw(e,j);wm_psp_charts.fill_color("HourlyUptime-"+h,h)},drawDailyUptime:function(b,h){var a=b.result[0].daily.length;if(a<1){wm_psp_charts.handleEmptyDataError("#DailyUptime-"+h,"chart");return false}var e=new google.visualization.DataTable();e.addRows(a);e.addColumn("string",wm_psp_charts.msgs.charts.hours);e.addColumn("number",wm_psp_charts.msgs.charts.uptime.name);var f,k=100,g;for(i=0;i<a;i++){f=b.result[0].daily[i];dateString=wm_psp_charts.getDateStr(f.period.from.sec*1000,b.result[0].info.tz,"date");g=parseInt(f.uptime,10);k=(k>g)?g:k;e.setValue(i,0,dateString);e.setValue(i,1,g)}var j={width:WM_instances[h].widget_width,height:WM_instances[h].widget_height,is3D:false,fontSize:wm_psp_charts.chart_options.font_size,pointSize:2,vAxis:{title:wm_psp_charts.msgs.charts.axis_titles.uptime_perc,minValue:k-1,maxValue:100,textStyle:{color:wm_psp_charts.msgs.charts.text_color}},hAxis:{title:wm_psp_charts.msgs.charts.days,showTextEvery:wm_psp_charts.chart_options.show_text_days,textStyle:{color:wm_psp_charts.msgs.charts.text_color}},isStacked:false,legend:"none",backgroundColor:{stroke:null,fill:wm_psp_charts.msgs.charts.backgroung_color,strokeWidth:0},gridlineColor:"#b2b2b2",colors:["#669900","#CC0000"],chartArea:wm_psp_charts.chart_options.area};if(80>k&&k>=70){j.vAxis.minValue=60}else{if(60>k&&k>=55){j.vAxis.minValue=40}else{if(40>k&&k>=0){j.vAxis.minValue=0}}}var c=document.getElementById("DailyUptime-"+h);var d=new google.visualization.AreaChart(c);d.draw(e,j);wm_psp_charts.fill_color("DailyUptime-"+h,h)},drawHourlyPageLoadTime:function(g,a){var h=g.result[0].hourly.length;if(h<1){wm_psp_charts.handleEmptyDataError("#HourlyPageLoadTime-"+a,"chart");return false}var f=new google.visualization.DataTable();f.addRows(h);f.addColumn("string",wm_psp_charts.msgs.charts.hours);f.addColumn("number",wm_psp_charts.msgs.charts.rtime.name);f.addColumn("number",wm_psp_charts.msgs.charts.ctime.name);f.addColumn("number",wm_psp_charts.msgs.charts.ptime.name);f.addColumn("number",wm_psp_charts.msgs.charts.ttime.name);var d;for(i=0;i<h;i++){d=g.result[0].hourly[i];dateString=wm_psp_charts.getDateStr(d.period.from.sec*1000,g.result[0].info.tz);f.setValue(i,0,dateString);f.setValue(i,1,(typeof(d.avg.rtime)!=="undefined")?parseInt(d.avg.rtime,10):0);f.setValue(i,2,(typeof(d.avg.ctime)!=="undefined")?parseInt(d.avg.ctime,10):0);f.setValue(i,3,(typeof(d.avg.ptime)!=="undefined")?parseInt(d.avg.ptime,10):0);f.setValue(i,4,(typeof(d.avg.dtime)!=="undefined")?parseInt(d.avg.dtime,10):0)}var c={width:WM_instances[a].widget_width,height:WM_instances[a].widget_height,is3D:false,fontSize:wm_psp_charts.chart_options.font_size,isStacked:true,pointSize:0,vAxis:{title:wm_psp_charts.msgs.charts.axis_titles.total_load_time,textStyle:{color:wm_psp_charts.msgs.charts.text_color}},hAxis:{title:wm_psp_charts.msgs.charts.hours,showTextEvery:wm_psp_charts.chart_options.show_text_hours,minValue:0,textStyle:{color:wm_psp_charts.msgs.charts.text_color}},legend:"bottom",backgroundColor:{stroke:null,fill:wm_psp_charts.msgs.charts.backgroung_color,strokeWidth:0},gridlineColor:"#b2b2b2",colors:["#BDBDBD","#CC0000","#669900","#EEA111"],chartArea:wm_psp_charts.chart_options.area_legend};var b=document.getElementById("HourlyPageLoadTime-"+a);var e=new google.visualization.AreaChart(b);e.draw(f,c);wm_psp_charts.fill_color("HourlyPageLoadTime-"+a,a)},drawWorldDailyPerformance:function(g,a){var h=g.result[0].world.length;if(h<1){wm_psp_charts.handleEmptyDataError("#WorldDailyPerformance-"+a,"chart");return false}var f=new google.visualization.DataTable();f.addRows(h+2);f.addColumn("string",wm_psp_charts.msgs.charts.country);f.addColumn("number",wm_psp_charts.msgs.charts.performance);f.setValue(h,1,0);f.setValue(h+1,1,100);var d,b;for(i=0;i<h;i++){d=g.result[0].world[i];b=typeof(wm_psp_charts.country_names[d.id])==="undefined"?d.id.toUpperCase():wm_psp_charts.country_names[d.id];f.setValue(i,0,b);f.setValue(i,1,parseInt(d.score,10))}var e,c;if(wm_psp_charts.browser.flash.version<8){e=new google.visualization.ImageChart(document.getElementById("WorldDailyPerformance-"+a));c={chf:"bg,s,EAF7FE",cht:"t",chtm:"world",chco:"FFFFFF,CC0000,FF9900,CCFF66,009900",chs:"383x220",region:"regions",showZoomOut:region!=="world"}}else{e=new google.visualization.GeoMap(document.getElementById("WorldDailyPerformance-"+a));c={width:WM_instances[a].widget_width,height:WM_instances[a].widget_height,dataMode:"regions",is3D:false,colors:[13369344,16750848,13434726,39168]}}e.draw(f,c)},drawSparkline:function(e,j){var g=e.result.length,c=e.result[0].hourly.length;if(g<1){wm_psp_charts.handleEmptyDataError("#wm-chart-widget-"+j,"chart");return false}var d='<ul id="monitors-list-'+j+'" class="monitors-list"></ul>';jQuery("#wm-chart-widget-"+j).prepend(d);for(i=0;i<g;i++){parsed_results=e.result[i];c=parsed_results.hourly.length;var a=parsed_results.info.name,h=wm_psp_charts.getDateStr(parsed_results.cur.period.from.sec*1000,parsed_results.info.tz,"last"),f=parsed_results.cur.status;wm_psp_charts.createElement(j,"monitors-list",a,true,i,parsed_results.info.id,f,h);var b=[];for(y=0;y<(c-1);y++){parsed_data=parsed_results.hourly[y];b.push(parseInt(parsed_data.avg.ttime,10))}jQuery("#Sparkline-"+j+"-"+i).sparkline(b,{width:WM_instances[j].widget_width,height:"20px",lineColor:"#20a228",fillColor:"#d1e0b2"})}jQuery("#wm-chart-widget-"+j+" .loading").remove()},drawGauges:function(d,m){var h=d.result.length,l;if(h<1){wm_psp_charts.handleEmptyDataError("#Gauge-"+m,"chart");return false}var a=(WM_instances[m].widget_width<140)?140:WM_instances[m].widget_width;var g=new google.visualization.DataTable();g.addRows(h);g.addColumn("string","Label");g.addColumn("number","Value");for(i=0;i<h;i++){l=d.result[i];var b=l.cur.avg.ttime,j=l.info.timewarn,c=l.info.timepoor,k=l.info.timeout*1000;g.setValue(0,0,"ms");g.setValue(0,1,parseInt(b,10));var n={width:a,height:a,greenFrom:0,greenTo:j,yellowFrom:j,yellowTo:c,redFrom:c,redTo:k,minorTicks:5,majorTicks:10,min:0,max:k};var e=document.getElementById("Gauge-"+m+"-"+i);var f=new google.visualization.Gauge(e);f.draw(g,n)}},fill_color:function(b,a){if(WM_instances[a].widget_theme!=="none"){var c=jQuery("#"+b+" iframe");c.contents().find("body #chart g rect:first-child").attr("fill-opacity","0").attr("fill","none")}},renderChartArea:function(a,b){switch(b){case"HourlyUptime":msg=wm_psp_charts.msgs.captions.HourlyUptime;wm_psp_charts.createElement(a,b,msg);break;case"DailyUptime":msg=wm_psp_charts.msgs.captions.DailyUptime;wm_psp_charts.createElement(a,b,msg);break;case"HourlyPageLoadTime":msg=wm_psp_charts.msgs.captions.HourlyPageLoadTime;wm_psp_charts.createElement(a,b,msg);break;case"WorldDailyPerformance":msg=wm_psp_charts.msgs.captions.WorldDailyPerformance;wm_psp_charts.createElement(a,b,msg);break;case"Sparkline":msg=wm_psp_charts.msgs.captions.sparkline;wm_psp_charts.createElement(a,b,msg);break;case"Gauge":msg=wm_psp_charts.msgs.captions.gauges;wm_psp_charts.createElement(a,b,msg);break}},createElement:function(g,a,b,d,j,h,e,f){var c;if(d===true){f=(typeof(f)!=="undefined")?' alt="Uptime: '+f+'"':"";var k=((j%2)===0)?" odd":"";c='<li class="monitor '+k+'"><h4 class="status-'+e+'"><a href="'+wm_psp_charts.createLink(g,h,b)+'" title="'+wm_psp_charts.msgs.status_states[e].text+'">'+b+'</a><a class="toogle-info-charts" /></h4>\n<div class="info-charts" style="display:none;"><div id="Gauge-'+g+"-"+j+'"></div><p>'+wm_psp_charts.msgs.captions.Gauges+'</p><div id="Sparkline-'+g+"-"+j+'"></div><p>'+wm_psp_charts.msgs.captions.Sparkline+"</p></div></li>";jQuery("#"+a+"-"+g).append(c)}else{c='<div class="chart-con">\n<div class="chart-wrap">\n<div id="'+a+"-"+g+'" class="chart-item">\n<img height="16" width="16" class="loading" src="'+WM_instances[g].assets_folder_com+"images/ajax-loader_"+((wm_psp_charts.opts.widget_theme==="dark")?"dark":"light")+'.gif">\n</div>\n'+((wm_psp_charts.opts.widget_captions===1)?"<p>"+b+"</p>":'<p style="margin:0 0 8px"></p>')+"\n</div>\n</div>";jQuery(WM_instances[g].instance_container_id).append(c)}},styleChartArea:function(b){var c={};var e={};var f={margin:(WM_instances[b].widget_chart_gap/2)+" auto"};var a={width:WM_instances[b].widget_width,padding:WM_instances[b].widget_chart_padding+"px "+WM_instances[b].widget_chart_padding+"px","margin-right":WM_instances[b].widget_chart_gap+"px"};switch(WM_instances[b].widget_layout){case"horizontal":var g=(WM_instances[b].auto_size_charts===true)?"0 ":WM_instances[b].widget_chart_gap+"px ";c={margin:"0 "+g+WM_instances[b].widget_chart_gap+"px 0"};e={margin:"0px"};break;case"vertical":if(typeof(WM_instances[b].is_module)==="undefined"||WM_instances[b].is_module!==true){c={width:WM_instances[b].widget_width+2+(WM_instances[b].widget_chart_padding*2)+"px"}}c={margin:"0px 0px "+WM_instances[b].widget_chart_gap+"px"};e={margin:"0px"};break;case"columns":default:var d;if(WM_instances[b].auto_size_charts===true){d=WM_instances[b].widget_chart_padding*2}c={width:(WM_instances[b].widget_width+d)+"px",margin:"0 "+WM_instances[b].widget_chart_gap+"px "+WM_instances[b].widget_chart_gap+"px 0"};e={width:WM_instances[b].widget_width+"px",margin:"0px"};break}f=jQuery.extend(f,c);a=jQuery.extend(a,e);if(typeof(WM_instances[b].is_module)==="undefined"||WM_instances[b].is_module!==true){jQuery(WM_instances[b].instance_container_id).find(".chart-con").css(f).removeClass("wm-hidden");jQuery(WM_instances[b].instance_container_id).find(".chart-item").css(a);if(WM_instances[b].widget_layout==="columns"){jQuery(WM_instances[b].instance_container_id).find(".chart-con:nth-child(even)").css("margin-right","0px")}}else{jQuery(WM_instances[b].instance_container_id).removeClass("wm-hidden")}},handleError:function(e,a,b){var d="",c;switch(e){case"timeout":d=wm_psp_charts.msgs.request_timeout;c=true;break;case"error":d=wm_psp_charts.msgs.error;c=true;break;default:d=e;break}jQuery(WM_instances[a].instance_container_id).html('<div class="error">'+d+"</div>").removeClass("wm-hidden");if(c===true){jQuery(wm_psp_charts.opts.psp_page_uptime_table_id).replaceWith('<div id="'+wm_psp_charts.opts.psp_page_uptime_table_id+'" class="error margin-b19">'+d+"</div>").removeClass("wm-hidden");jQuery(".loading-uptime").remove();jQuery(wm_psp_charts.opts.psp_page_history_table_id).replaceWith('<div id="'+wm_psp_charts.opts.psp_page_history_table_id+'" class="error margin-b19">'+d+"</div>").removeClass("wm-hidden");jQuery(".loading-history").remove()}if(b===true){jQuery("#psp-tables-con").html('<div class="error margin-b19">'+d+"</div>")}},handleEmptyDataError:function(b,c){if(c==="chart"){jQuery(b).parent().addClass("error").css("padding","20px").html(wm_psp_charts.msgs.empty_chart_data)}else{var a='<tr>\n<td colspan="'+c+'" align="center" class="caution">'+wm_psp_charts.msgs.empty_chart_data+"</td>\n</tr>";jQuery(b).append(a)}},initiate:function(a){WM_instances[a].instance_container_id=wm_psp_charts.opts.widget_container_id+"-"+a;WM_instances[a].instance_mod_container_id=wm_psp_charts.opts.widget_mod_container_id+"-"+a;filter_style=/^[1-3]{1}$/;WM_instances[a].widget_style=(filter_style.test(WM_instances[a].widget_style))?WM_instances[a].widget_style:2;filter_numbers=/^[0-9]{1,4}$/;if(WM_instances[a].widget_width===0){WM_instances[a].widget_width=jQuery(WM_instances[a].instance_container_id).width();if(WM_instances[a].widget_width<740&&WM_instances[a].widget_html_markup!=="table"){WM_instances[a].widget_layout="vertical"}if(WM_instances[a].widget_height===0){if(WM_instances[a].widget_layout==="columns"){WM_instances[a].widget_width=parseInt(((WM_instances[a].widget_width-12-4-WM_instances[a].widget_chart_gap-(WM_instances[a].widget_chart_padding*4))/2),10)}WM_instances[a].widget_height=WM_instances[a].widget_width/1.7;WM_instances[a].widget_height=parseInt(WM_instances[a].widget_height,10)}else{WM_instances[a].widget_height=(filter_numbers.test(WM_instances[a].widget_height)&&WM_instances[a].widget_height<800)?parseInt(WM_instances[a].widget_height,10):320}WM_instances[a].auto_size_charts=true}else{WM_instances[a].widget_width=((typeof(WM_instances[a].widget_width)!=="undefined")&&filter_numbers.test(WM_instances[a].widget_width)&&WM_instances[a].widget_width<1200)?parseInt(WM_instances[a].widget_width,10):454;WM_instances[a].widget_height=((typeof(WM_instances[a].widget_height)!=="undefined")&&filter_numbers.test(WM_instances[a].widget_height)&&WM_instances[a].widget_height<800)?parseInt(WM_instances[a].widget_height,10):320}jQuery(WM_instances[a].instance_container_id).find(".chart-item").css({width:WM_instances[a].widget_width,height:WM_instances[a].widget_height});if(typeof(WM_instances[a].is_module)==="undefined"){if(2000>WM_instances[a].widget_width&&WM_instances[a].widget_width>=1000){wm_psp_charts.chart_options.area={top:10,left:100,height:"90%",width:"90%"};wm_psp_charts.chart_options.area_legend={top:10,left:100,height:"84%",width:"90%"};wm_psp_charts.chart_options.font_size="11";wm_psp_charts.chart_options.show_text_hours="3";wm_psp_charts.chart_options.show_text_days="1"}else{if(1000>WM_instances[a].widget_width&&WM_instances[a].widget_width>=550){wm_psp_charts.chart_options.area={top:10,left:70,height:"82%",width:"86%"};wm_psp_charts.chart_options.area_legend={top:10,left:70,height:"74%",width:"86%"};wm_psp_charts.chart_options.font_size="11";wm_psp_charts.chart_options.show_text_hours="3";wm_psp_charts.chart_options.show_text_days="1"}else{if(550>WM_instances[a].widget_width&&WM_instances[a].widget_width>=300){wm_psp_charts.chart_options.area={top:10,left:55,height:"77%",width:"82%"};wm_psp_charts.chart_options.area_legend={top:10,left:55,height:"72%",width:"82%"};wm_psp_charts.chart_options.font_size="10";wm_psp_charts.chart_options.show_text_hours="4";wm_psp_charts.chart_options.show_text_days="2"}else{if(300>WM_instances[a].widget_width&&WM_instances[a].widget_width>=220){wm_psp_charts.chart_options.area={top:10,left:55,height:"74%",width:"82%"};wm_psp_charts.chart_options.area_legend={top:10,left:55,height:"67%",width:"82%"};wm_psp_charts.chart_options.font_size="9";wm_psp_charts.chart_options.show_text_hours="5";wm_psp_charts.chart_options.show_text_days="2"}else{if(220>WM_instances[a].widget_width&&WM_instances[a].widget_width>=100){wm_psp_charts.chart_options.area={top:3,left:55,height:"70%",width:"88%"};wm_psp_charts.chart_options.area_legend={top:3,left:55,height:"64%",width:"88%"};wm_psp_charts.chart_options.font_size="8";wm_psp_charts.chart_options.show_text_hours="10";wm_psp_charts.chart_options.show_text_days="2"}}}}}}WM_instances[a].widget_chart_gap=((typeof(WM_instances[a].widget_chart_gap)!=="undefined")&&filter_numbers.test(WM_instances[a].widget_chart_gap)&&WM_instances[a].widget_chart_gap<100)?parseInt(WM_instances[a].widget_chart_gap,10):20;WM_instances[a].widget_chart_padding=((typeof(WM_instances[a].widget_chart_padding)!=="undefined")&&filter_numbers.test(WM_instances[a].widget_chart_padding)&&WM_instances[a].widget_chart_padding<100)?parseInt(WM_instances[a].widget_chart_padding,10):8;filter_theme=/^[a-z]{2,15}$/;WM_instances[a].widget_theme=((typeof(WM_instances[a].widget_theme)!=="undefined")&&filter_theme.test(WM_instances[a].widget_theme))?WM_instances[a].widget_theme:"none";WM_instances[a].widget_layout=((typeof(WM_instances[a].widget_layout)!=="undefined")&&filter_theme.test(WM_instances[a].widget_layout))?WM_instances[a].widget_layout:"vertical";filter_captions=/^[01]$/;WM_instances[a].widget_captions=(filter_captions.test(WM_instances[a].widget_captions))?WM_instances[a].widget_captions:1;WM_instances[a].assets_folder_com=(typeof(WM_instances[a].assets_folder_com)!=="undefined")?WM_instances[a].assets_folder_com:"assets/";if(WM_instances[a].widget_theme==="light"){wm_psp_charts.msgs.charts.backgroung_color="#e0e0e0"}return false},moduleInstances:function(a){wm_psp_charts.initiate(a);if(typeof(WM_instances[a].uid)==="undefined"||WM_instances[a].uid===0){wm_psp_charts.handleError(wm_psp_charts.msgs.uid_not_valid,a,true);return false}if(typeof(WM_instances[a].rid)==="undefined"){if(typeof(WM_instances[a].fid)==="undefined"||WM_instances[a].fid===0){wm_psp_charts.handleError(wm_psp_charts.msgs.rid_not_valid,a,true);return false}}WM_instances[a].fields="fields=info";var c=WM_instances[a].chart_types.length,e=new Array();if(wm_psp_charts.iframe_version_widget===true&&WM_instances[a].widget_theme!=="none"){jQuery(WM_instances[a].instance_container_id).addClass("wm-"+WM_instances[a].widget_theme)}for(i=0;i<c;i++){if(wm_psp_charts.iframe_version_widget===true){wm_psp_charts.renderChartArea(a,WM_instances[a].chart_types[i])}switch(WM_instances[a].chart_types[i]){case"PSPPage":WM_instances[a].fields+=";cur.status;24h.avg.ttime;24h.uptime;24h.period.from;daily.status;daily.uptime;daily.period.from;last.date";break;case"HourlyUptime":WM_instances[a].fields+=";hourly.uptime;hourly.downtime;hourly.period.from";e[i]="corechart";break;case"DailyUptime":WM_instances[a].fields+=";daily.uptime;daily.downtime;daily.period.from";e[i]="corechart";break;case"WorldDailyPerformance":WM_instances[a].fields+=";world.id;world.score";e[i]=wm_psp_charts.browser.flash.version<8?"imagechart":"geomap";wm_psp_charts.loadCountryNames();break;case"HourlyPageLoadTime":WM_instances[a].fields+=";hourly.avg;hourly.period.from";e[i]="corechart";break;case"Sparkline":WM_instances[a].fields+=";hourly.avg;cur.status;cur.period.from";break;case"Gauge":WM_instances[a].fields+=";cur.avg";e[i]="gauge";break;case"ChartPage":WM_instances[a].fields+=";last.date;cur.status;daily.status;daily.period.from";break}}var b=e.sort();var d=[];for(i=0;i<b.length;i++){if(b[i]!==b[i+1]){d.push(b[i])}}WM_instances[a].visualization_packages=d;if(WM_instances[a].widget_html_markup!=="table"){wm_psp_charts.styleChartArea(a)}else{jQuery(WM_instances[a].instance_container_id).find(".chart-con").removeClass("wm-hidden")}wm_psp_charts.initMap(a)},makeDate:function(a,b){return new Date(parseInt(a,10)+(b-wm_psp_charts.browser.offset)*60*60*1000)},getDateStr:function(e,j,f,g){j=parseInt(j,10);var h=wm_psp_charts.makeDate(e,j),a;if(f==="date"){return wm_psp_charts.msgs.months[h.getMonth()]+" "+h.getDate()}else{var b=h.getHours();b=b<10?b="0"+b:b;var c=h.getMinutes();c=(c<10)?"0"+c:c;if(f==="last"){a=wm_psp_charts.msgs.months[h.getMonth()]+" "+h.getDate()+", "+h.getFullYear()+" "+b+":"+c;a+=(j?" UTC"+((j>0?"+":"")+j):" UTC")}else{a=b+":"+c}return a}return false},fillDates:function(c){var a=null;for(i=0;i<c.result.length;i++){if(typeof(c.result[i].last)!=="undefined"){var g=wm_psp_charts.makeDate(c.result[i].last.date.sec*1000,c.result[i].info.tz),b=wm_psp_charts.getDateStr(c.result[i].last.date.sec*1000,c.result[i].info.tz,"last");if(a===null||a.getTime()<g.getTime()){a=g;monitor_last_update=b}}}startDateYear=a.getFullYear();startDateMonth=a.getMonth();startDateDay=a.getDate();if(monitor_last_update!==""){jQuery(wm_psp_charts.opts.psp_page_last_update).html(monitor_last_update).removeClass("wm-hidden")}a=new Date(a.getFullYear(),a.getMonth(),a.getDate());var f=[];jQuery("#hist_date_0").html(wm_psp_charts.msgs.months[a.getMonth()]+" "+a.getDate());f[0]=a;for(i=1;i<7;i++){var e=new Date(startDateYear,startDateMonth,startDateDay-i);jQuery("#hist_date_"+i).html(wm_psp_charts.msgs.months[e.getMonth()]+" "+e.getDate());f[i]=e}wm_psp_charts.weekDates=f},loadCountryNames:function(){jQuery.jsonp({url:wm_psp_charts.urls.s3_url_assets+"/js/countries_en.js?callback=?",cache:true,timeout:10000,callback:"setCountries",error:function(b,a){},success:function(a){wm_psp_charts.country_names=a}})},SortByName:function(a,b){return((a.info.name===b.info.name)?0:((a.info.name>b.info.name)?1:-1))},round_number:function(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)},browser:{offset:-(new Date()).getTimezoneOffset()/60,navigator:navigator,flash:{version:0,enabled:false},isIE:/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent),init:function(){this.checkFlash()},checkFlash:function(){if(typeof this.navigator.plugins!=="undefined"&&typeof this.navigator.plugins["Shockwave Flash"]==="object"){this.d=this.navigator.plugins["Shockwave Flash"].description;if(this.d&&!(typeof this.navigator.mimeTypes!=="undefined"&&this.navigator.mimeTypes["application/x-shockwave-flash"]&&!this.navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)){this.flash.enabled=true;this.d=this.d.replace(/^.*\s+(\S+\s+\S+$)/,"$1");this.flash.version=parseInt(this.d.replace(/^(.*)\..*$/,"$1"),10)}}else{if(typeof this.window.ActiveXObject!=="undefined"){try{this.a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(this.a){this.d=this.a.GetVariable("$version");if(this.d){this.flash.enabled=true;this.d=this.d.split(" ")[1].split(",");this.flash.version=parseInt(this.d[0],10)}}}catch(a){}}}}},render_psp:function(){(function(Z,ac){function aa(){}function I(d){ab=[d]}function R(d){Y.insertBefore(d,Y.firstChild)}function S(d,f,e){return d&&d.apply(f.context||f,e)}function T(d){return/\?/.test(d)?"&":"?"}var Q="async",J="charset",M="",N="error",K="_jqjsp",F="on",P=F+"click",O=F+N,ad=F+"load",V=F+"readystatechange",C="removeChild",X="<script/>",G="success",D="timeout",E=Z.browser,Y=Z("head")[0]||document.documentElement,H={},U=0,ab,W={callback:K,url:location.href};function L(e){e=Z.extend({},W,e);var g=e.complete,t=e.dataFilter,l=e.callbackParameter,f=e.callback,r=e.cache,o=e.pageCache,p=e.charset,d=e.url,m=e.data,h=e.timeout,j,n=0,q=aa;e.abort=function(){!n++&&q()};if(S(e.beforeSend,e,[e])===false||n){return e}d=d||M;m=m?((typeof m)=="string"?m:Z.param(m,e.traditional)):M;d+=m?(T(d)+m):M;l&&(d+=T(d)+encodeURIComponent(l)+"=?");!r&&!o&&(d+=T(d)+"_"+(new Date()).getTime()+"=");d=d.replace(/=\?(&|$)/,"="+f+"$1");function k(u){!n++&&ac(function(){q();o&&(H[d]={s:[u]});t&&(u=t.apply(e,[u]));S(e.success,e,[u,G]);S(g,e,[e,G])},0)}function s(u){!n++&&ac(function(){q();o&&u!=D&&(H[d]=u);S(e.error,e,[e,u]);S(g,e,[e,u])},0)}o&&(j=H[d])?(j.s?k(j.s[0]):s(j)):ac(function(w,x,v){if(!n){v=h>0&&ac(function(){s(D)},h);q=function(){v&&clearTimeout(v);w[V]=w[P]=w[ad]=w[O]=null;Y[C](w);x&&Y[C](x)};window[f]=I;w=Z(X)[0];w.id=K+U++;if(p){w[J]=p}function u(A){(w[P]||aa)();A=ab;ab=undefined;A?k(A[0]):s(N)}if(E.msie){w.event=P;w.htmlFor=w.id;w[V]=function(){/loaded|complete/.test(w.readyState)&&u()}}else{w[O]=w[ad]=u;E.opera?((x=Z(X)[0]).text="jQuery('#"+w.id+"')[0]."+O+"()"):w[Q]=Q}w.src=d;R(w);x&&R(x)}},0);return e}L.setup=function(d){Z.extend(W,d)};Z.jsonp=L})(jQuery,setTimeout);if(wm_psp_charts.iframe_version_widget!==true&&(typeof(wm_assets_folder_mod)!=="undefined")){var b=document.createElement("script");b.type="text/javascript";b.async=true;b.src=wm_assets_folder_mod+"js/jquery.sparkline.min.js";var c=document.getElementsByTagName("head")[0];c.appendChild(b)}wm_psp_charts.browser.init();if(typeof(wm_lang)!=="undefined"){wm_psp_charts.msgs=jQuery.extend(wm_psp_charts.msgs,wm_lang)}for(var a in WM_instances){wm_psp_charts.moduleInstances(a)}if(wm_psp_charts.iframe_version_widget!==true){jQuery(".wm-widget-module .toogle-info-charts").live("click",function(){jQuery(this).parent().parent().find(".info-charts").slideToggle()});jQuery(".wm-tooltip").live("mouseover mouseout",function(d){if(d.type==="mouseover"){var e=jQuery(this).attr("alt");jQuery('body').append('<div class="wm-img-tooltip"><span class="wm-tooltip-inner">'+e+"</span></div>").find(".wm-img-tooltip").css("top",(d.pageY-20)+"px").css("left",(d.pageX-280)+"px")}else{jQuery('body').find(".wm-img-tooltip").remove()}})}},};wm_psp_charts.opts=wm_psp_charts.widget_defaults.defaults;wm_psp_charts.msgs=wm_psp_charts.widget_defaults.messages;wm_psp_charts.chart_options=wm_psp_charts.widget_defaults.chart_options;wm_psp_charts.country_names=wm_psp_charts.widget_defaults.country_names;wm_psp_charts.urls=wm_psp_charts.widget_defaults.urls;wm_psp_charts.iframe_version_widget=(typeof(wm_iframe_version_widget)!=="undefined")?true:false;jQuery(document).ready(function(){wm_psp_charts.render_psp()});